<!DOCTYPE html>
<html lang="zh-CN">

<!-- Head tag -->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <!--Description-->
  

  <!--Author-->
  
  <meta name="author" content="ZiHan.Xia">
  

  <!--Open Graph Title-->
  
      <meta property="og:title" content="iOSç®€å•å¤šçº§ä¸‹æ‹‰èœå•å¼€å‘"/>
  
  <!--Open Graph Description-->
  
  <!--Open Graph Site Name-->
  <meta property="og:site_name" content="ZiHan Blog"/>
  <!--Type page-->
  
      <meta property="og:type" content="article" />
  
  <!--Page Cover-->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- Title -->
  
  <title>iOSç®€å•å¤šçº§ä¸‹æ‹‰èœå•å¼€å‘ - ZiHan Blog</title>


  <link rel="shortcut icon" href="http://op6guxky2.bkt.clouddn.com/logo@2x.png">

  <!-- Custom CSS/Sass -->
  <link rel="stylesheet" href="/css/style.css">

  <!----------------------------
  https://github.com/GallenHu/hexo-theme-Daily

 _____            _   _
|  __ \          (_) | |
| |  | |   __ _   _  | |  _   _
| |  | |  / _` | | | | | | | | |
| |__| | | (_| | | | | | | |_| |
|_____/   \__,_| |_| |_|  \__, |
                          __/ |
                         |___/

    --------------------------->

</head>


<body>

  <!-- Nav -->
  <header class="site-header">
  <div class="header-inside">
    <div class="logo">
      <a href="/" rel="home">
        
        <img src="http://op6guxky2.bkt.clouddn.com/logo@2x.png" alt="ZiHan Blog" height="60">
        
      </a>
    </div>
    <!-- Navigation -->
    <nav class="navbar">
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse">
        <ul class="navbar-nav">
          
          
            <li>
              <a href="/.">
                
                  home
                
              </a>
            </li>
          
            <li>
              <a href="/archives">
                
                  archive
                
              </a>
            </li>
          
            <li>
              <a href="/about">
                
                  about
                
              </a>
            </li>
          
        </ul>
      </div>
      <!-- /.navbar-collapse -->
    </nav>
    <div class="button-wrap">
      <button class="menu-toggle">Primary Menu</button>
    </div>
  </div>
</header>


  <!-- Main Content -->
  <div class="content-area">
  <div class="post">
    <!-- Post Content -->
    <div class="container">
      <article>
        <!-- Title date & tags -->
        <div class="post-header">
          <h1 class="entry-title">
            iOSç®€å•å¤šçº§ä¸‹æ‹‰èœå•å¼€å‘
            
          </h1>
          <p class="posted-on">
          2017-08-11
          </p>
          <div class="tags-links">
            
              
            
          </div>
        </div>
        <!-- Post Main Content -->
        <div class="entry-content">
          <h2 id="iOSå¤šçº§ä¸‹æ‹‰èœå•å¼€å‘"><a href="#iOSå¤šçº§ä¸‹æ‹‰èœå•å¼€å‘" class="headerlink" title="iOSå¤šçº§ä¸‹æ‹‰èœå•å¼€å‘"></a><div style="text-align:center">iOSå¤šçº§ä¸‹æ‹‰èœå•å¼€å‘<div></div></div></h2><p>ä¸ºæ¥ä¸‹æ¥æˆ‘ä»¬è¦åšä»€ä¹ˆæœ‰ä¸ªåº•ï¼Œå…ˆæ¥çœ‹çœ‹å®Œæˆåçš„æ•ˆæœå›¾ã€‚æ€»çš„æ¥è¯´æˆ‘ä»¬è¦å®ç°è¿™æ ·ä¸€ä¸ªä¸‹æ‹‰æ§ä»¶ï¼Œç‚¹å‡»åŸå¸‚æŒ‰é’®ï¼Œå°±ä¼šå¼¹å‡ºåŸå¸‚é€‰æ‹©ä¸‹æ‹‰åˆ—è¡¨ï¼Œç‚¹å‡»ç¬¬ä¸€åˆ—æˆ–è€…ç¬¬äºŒåˆ—å°±ä¼šæ ¹æ®ç‚¹å‡»çš„è¡Œåˆ·æ–°åé¢çš„åˆ—è¡¨ï¼Œæ¯”å¦‚ç‚¹å‡»äº†çœä»½è¿™ä¸€åˆ—ä¼šæ›´æ–°ç›¸åº”çš„åŸå¸‚åˆ—è¡¨å’ŒåŒºå¿åˆ—è¡¨ï¼Œå¤§æ¦‚å¯ä»¥ç”¨<font color="#FF8C00">çº§è”æ›´æ–°</font>è¿™ä¸ªè¯æ¥æè¿°å§ï¼åœ¨ç‚¹å‡»æœ€åä¸€åˆ—ååˆ—è¡¨ä¼šæ¶ˆå¤±ï¼Œç‚¹å‡»ç°è‰²åŒºåŸŸåŸå¸‚åˆ—è¡¨ä¹Ÿä¼šæ¶ˆå¤±ï¼Œåœ¨åˆ—è¡¨å±•ç¤ºçš„æƒ…å†µä¸‹ï¼Œç‚¹å‡»åŸå¸‚æŒ‰é’®ï¼ŒåŸå¸‚åˆ—è¡¨ä¹Ÿä¼šæ¶ˆå¤±ã€‚åœæ­¢å“”å“”ğŸ¤£ğŸ˜‚ï¼Œæ’¸èµ·è¢–å­å¼€å§‹å¹²ï¼</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/%E5%AE%8C%E6%88%90%E6%95%88%E6%9E%9C%E5%9B%BE.png?imageView2/2/w/375" alt=""></p>
<p>æˆ‘ä»¬è¿™æ¬¡çš„é‡ç‚¹æ˜¯å¤šçº§ä¸‹æ‹‰åˆ—è¡¨çš„å¼€å‘ï¼Œå› æ­¤æˆ‘ä»¬ä»ä¸€ä¸ªåˆå§‹é¡¹ç›®å¼€å§‹ï¼Œç›´æ¥è¿›å…¥ä¸‹æ‹‰åˆ—è¡¨çš„å¼€å‘çš„å¼€å‘ç¯èŠ‚ğŸ¤¡ğŸ¤¡ã€‚ä»è¿™é‡Œä¸‹è½½æˆ‘ä»¬çš„<a href="https://github.com/EgeTart/MlutiLevelMenuDemo/tree/6cdb271ca7b7b515ab7ade87411702f4e56d48cd">åˆå§‹é¡¹ç›®</a>ï¼Œä¸‹å›¾æ˜¯åˆå§‹é¡¹ç›®è¿è¡Œåçš„ç»“æœã€‚</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/%E5%88%9D%E5%A7%8B%E9%A1%B9%E7%9B%AE%E6%95%88%E6%9E%9C.png?imageView2/2/w/375" alt=""></p>
<p>åšä¸€ä¸ªå°å°çš„è¯´æ˜ï¼š</p>
<blockquote>
<ul>
<li>è¿™æ¬¡æˆ‘ä»¬é¡¹ç›®ä¸­ä½¿ç”¨<font color="#FF8C00">SnapKit</font>ä»¥çº¯ä»£ç çš„æ–¹å¼è¿›è¡Œç•Œé¢å¸ƒå±€ï¼Œä¸ç†Ÿæ‚‰çš„æœ‹å‹ä¸åŒæ‹…å¿ƒï¼Œæˆ‘ä»¬çš„Demoé¡¹ç›®ç•Œé¢æ¯”è¾ƒç®€å•ï¼Œå¸ƒå±€ä»£ç ä¹Ÿæ˜¯ç®€æ´æ˜äº†çš„ã€‚</li>
<li>å¦å¤–åŸå¸‚åˆ—è¡¨æ•°æ®æ ¼å¼ä¸ºjsonï¼Œæˆ‘ä»¬é€šè¿‡<font color="#FF8C00">Unbox</font>ç¬¬ä¸‰æ–¹åº“ï¼Œå°†jsonæ•°æ®è½¬æˆé¡¹ç›®ä¸­å¯ä»¥ä½¿ç”¨çš„Model</li>
<li>è¿™ä¸¤ä¸ªåº“å·²ç»é€šè¿‡podå®‰è£…ï¼ŒåŒ…å«åœ¨åˆå§‹é¡¹ç›®ä¸­ï¼Œåˆå§‹åˆ—è¡¨è¿˜åŒ…æ‹¬åŸå¸‚åˆ—è¡¨æ•°æ®</li>
</ul>
</blockquote>
<p>ä»æ­¤åˆ»å¼€å§‹æˆ‘ä»¬çš„å¤šçº§ä¸‹æ‹‰æ§ä»¶å«åš<font color="#FF8C00">MultiLevelMenu</font></p>
<p>æˆ‘ä»¬ä½¿ç”¨å¤šä¸ªUITableViewæ¥å®ç°å¤šä¸ªåˆ—è¡¨ï¼Œä»å®Œæˆæ•ˆæœå›¾æ¥çœ‹ï¼Œè¿™é‡Œæœ‰3ä¸ªUITableViewå¯¹è±¡ï¼Œå¯æ˜¯ä¸ºäº†æŠŠè¿™ä¸ªMultiLevelMenuæ§ä»¶åšæˆä¸€ä¸ªé€šç”¨æ§ä»¶ï¼Œæˆ‘ä»¬éœ€è¦è®©å¤–ç•Œæä¾›ç»™æ•°æ®ç»™MultiLevelMenuï¼Œç„¶åè¿›è¡Œå±•ç¤ºã€‚ç±»ä¼¼UITableViewçš„æ•°æ®æºæ–¹æ³•ï¼Œæˆ‘ä»¬ä¹Ÿä¼šåˆ›å»º<font color="#FF8C00">DataSource åè®®</font>ï¼Œè®©å¤–ç•Œé€šè¿‡è¿™ä¸ªåè®®ä¸ºMultiLevelMenuæä¾›æ•°æ®ã€‚</p>
<p><strong>å¥½å¼€å¿ƒï¼Œå¥½å¼€å¿ƒï¼Œç»ˆäºå¯ä»¥æ•²ä»£ç äº†ğŸ˜ˆğŸ˜ˆğŸ˜ˆï¼</strong></p>
<p>æ‰“å¼€é¡¹ç›®æ–‡ä»¶å¯¼èˆªæ ï¼Œé€‰ä¸­<font color="#FF8C00">View</font>è¿™ä¸ªGroupï¼Œï¼ˆcommand + nï¼‰åˆ›å»ºä¸€ä¸ªUIViewçš„å­ç±»<font color="#FF8C00">MultiLevelMenu</font>ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„å¤šçº§ä¸‹æ‹‰åˆ—è¡¨å•¦ï¼åˆšåˆšçš„æ“ä½œå¯ä»¥çœ‹ä¸€çœ‹ä¸‹é¢çš„æ­¥éª¤æˆªå›¾ã€‚</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/%E6%AD%A5%E9%AA%A41.png" alt=""></p>
<p>æ‰“å¼€<font color="#FF8C00">MultiLevelMenu.swift</font>æ–‡ä»¶ï¼Œæ·»åŠ åˆå§‹åŒ–æ–¹æ³•ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†èƒŒæ™¯è‰²è®¾ç½®ä¸ºé»‘è‰²ï¼Œé€æ˜åº¦ä¸º0.5ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ï¼Œåœ¨å±•ç¤ºMultiLevelMenuæ§ä»¶æ—¶ï¼Œä¼šæœ‰ä¸€å±‚ç°é»‘è‰²è’™ç‰ˆï¼Œå…·ä½“å¯ä»¥å‚è€ƒå®Œæˆåçš„æ•ˆæœå›¾ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MultiLevelMenu</span>: <span class="title">UIView</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</div><div class="line">        <span class="keyword">self</span>.backgroundColor = <span class="type">UIColor</span>(white: <span class="number">0</span>, alpha: <span class="number">0.5</span>)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">        <span class="built_in">fatalError</span>(<span class="string">"init(coder:) has not been implemented"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ç±»MultiLevelMenuå®šä¹‰çš„ä¸Šæ–¹ï¼Œæ·»åŠ ä¸€ä¸ªæ•°æ®æºåè®®<font color="#FF8C00">MultiLevelMenuDataSource</font>ï¼Œå£°æ˜å¦‚ä¸‹</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@objc</span> <span class="class"><span class="keyword">protocol</span> <span class="title">MultiLevelMenuDataSource</span>: <span class="title">NSObjectProtocol</span> </span>&#123;</div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">numberOfLevel</span><span class="params">(of multiLevelMenu: MultiLevelMenu)</span></span> -&gt; <span class="type">Int</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨MultiLevelMenuDataSourceå£°æ˜ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¤–ç•Œé€šè¿‡è¿™ä¸ªæ•°æ®æºæ–¹æ³•ï¼Œå‘Šè¯‰MultiLevelMenuè¦æ˜¾ç¤ºå¤šå°‘ä¸ªçº§åˆ«çš„æ•°æ®ï¼Œæ¯”å¦‚è¿”å›3ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰3ä¸ªåˆ—è¡¨ã€‚MultiLevelMenué€šè¿‡è¿™ä¸ªæ•°æ®æºæ–¹æ³•ï¼Œé…ç½®åˆ—è¡¨å’Œæ•°æ®ã€‚</p>
<p>æ•°æ®æºåè®®å£°æ˜å¥½äº†ï¼Œæˆ‘ä»¬åœ¨MultiLevelMenuç±»ä¸­æ·»åŠ ä¸€ä¸ª<font color="#FF8C00">dataSource</font>å±æ€§ï¼Œä»£è¡¨æ•°æ®æºã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">weak</span> <span class="keyword">var</span> dataSource: <span class="type">MultiLevelMenuDataSource</span>?</div></pre></td></tr></table></figure>
<p>æš‚æ—¶æŠŠæ•°æ®æºæ”¾ä¸€æ”¾ï¼Œä¸ºäº†åœ¨table viewä¸Šå±•ç¤ºåŸå¸‚ä¿¡æ¯ï¼Œå®šä¹‰ä¸€ä¸ªUITableViewCellçš„å­ç±»<font color="#FF8C00">LevelItemCell</font>ï¼Œåœ¨MultiLevelMenuDataSourceçš„å£°æ˜ä¸‹é¢å®šä¹‰è¿™ä¸ªç±»ã€‚è¿™ä¸ªcelléå¸¸ç®€å•ï¼ŒåªåŒ…å«äº†ä¸€ä¸ªlabelæ§ä»¶ï¼Œè®¾ç½®äº†labelçš„æ–‡å­—å±…ä¸­ã€‚åŒæ—¶ä¸ºLevelItemCellå¢åŠ äº†ç´«è‰²é€‰ä¸­æ•ˆæœã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">fileprivate</span> <span class="class"><span class="keyword">class</span> <span class="title">LevelItemCell</span>: <span class="title">UITableViewCell</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> levelNamelabel: <span class="type">UILabel</span> = &#123;</div><div class="line">        <span class="keyword">let</span> label = <span class="type">UILabel</span>()</div><div class="line">        label.font = <span class="type">UIFont</span>.systemFont(ofSize: <span class="number">14</span>)</div><div class="line">        label.textAlignment = .center</div><div class="line">        <span class="keyword">return</span> label</div><div class="line">    &#125;()</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(style: <span class="type">UITableViewCellStyle</span>, reuseIdentifier: <span class="type">String</span>?) &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(style: style, reuseIdentifier: reuseIdentifier)</div><div class="line">        <span class="keyword">self</span>.backgroundColor = <span class="type">UIColor</span>.clear</div><div class="line">        </div><div class="line">        <span class="comment">// å¸ƒå±€label</span></div><div class="line">        <span class="keyword">self</span>.contentView.addSubview(levelNamelabel)</div><div class="line">        levelNamelabel.snp.makeConstraints &#123; (make) <span class="keyword">in</span></div><div class="line">            make.edges.equalToSuperview().inset(<span class="type">UIEdgeInsetsMake</span>(<span class="number">8</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">12</span>))</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// æ·»åŠ ç´«è‰²é€‰ä¸­æ•ˆæœ</span></div><div class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</div><div class="line">        view.backgroundColor = <span class="type">UIColor</span>(red: <span class="number">198</span> / <span class="number">255.0</span>, green: <span class="number">165</span> / <span class="number">255.0</span>, blue: <span class="number">223</span> / <span class="number">255.0</span>, alpha: <span class="number">0.3</span>)</div><div class="line">        <span class="keyword">self</span>.selectedBackgroundView = view</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">        <span class="built_in">fatalError</span>(<span class="string">"init(coder:) has not been implemented"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œæœ‰äº†LevelItemCellï¼Œæ¥ç€å°±è¦åœ¨table viewä¸­å±•ç¤ºå®ƒä»¬äº†ã€‚å›åˆ°MultiLevelMenuç±»ä¸­ï¼Œåœ¨<font color="#FF8C00">init(frame: CGRect)</font>åˆå§‹åŒ–æ–¹æ³•çš„ä¸Šæ–¹ï¼Œæ·»åŠ 3ä¸ªç§æœ‰å˜é‡ï¼Œåˆ†åˆ«ä»£è¡¨cellçš„é‡ç”¨æ ‡è¯†ç¬¦ï¼Œæœ‰å¤šå°‘çº§åˆ—è¡¨éœ€è¦å±•ç¤ºï¼Œä»¥åŠå­˜å‚¨å±•ç¤ºçš„åˆ—è¡¨ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">fileprivate</span> <span class="keyword">let</span> <span class="type">LevelItemCellReuseIdentifier</span> = <span class="string">"LevelItemCellReuseIdentifier"</span></div><div class="line"><span class="keyword">fileprivate</span> <span class="built_in">lazy</span> <span class="keyword">var</span> numberOfLvel = <span class="number">0</span></div><div class="line"><span class="keyword">fileprivate</span> <span class="built_in">lazy</span> <span class="keyword">var</span> menuTableViews = [<span class="type">UITableView</span>]()</div></pre></td></tr></table></figure>
<p>å†æ·»åŠ ä¸€ä¸ªå®¹å™¨viewï¼Œæˆ‘ä»¬çš„åŸå¸‚åˆ—è¡¨éƒ½ä¼šæ”¾åœ¨è¿™ä¸ªå®¹å™¨viewä¸­ï¼Œæ–¹ä¾¿ç®¡ç†å’Œå®ç°ä¸€äº›åŠ¨ç”»æ•ˆæœã€‚åœ¨menuTableViewså˜é‡çš„ä¸‹æ–¹ï¼Œåˆ›å»ºè¿™ä¸ªview</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="built_in">lazy</span> <span class="keyword">var</span> containerView: <span class="type">UIView</span> = &#123;</div><div class="line">    <span class="keyword">let</span> view = <span class="type">UIView</span>()</div><div class="line">    <span class="keyword">return</span> view</div><div class="line">&#125;()</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨MultiLevelMenuç±»ä¸­æ·»åŠ ä¸¤ä¸ªç§æœ‰æ–¹æ³•ï¼Œç”¨æ¥åˆ›å»ºå±•ç¤ºåŸå¸‚æ•°æ®çš„table viewï¼Œä»¥åŠå¯¹table viewè¿›è¡Œå¸ƒå±€ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åˆ›å»ºtable view</span></div><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">createMenuTableView</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">for</span> level <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="keyword">self</span>.numberOfLvel &#123;</div><div class="line">        <span class="keyword">let</span> tableView = <span class="type">UITableView</span>()</div><div class="line">        tableView.register(<span class="type">LevelItemCell</span>.<span class="keyword">self</span>, forCellReuseIdentifier: <span class="type">LevelItemCellReuseIdentifier</span>)</div><div class="line">        tableView.tag = <span class="number">100</span> + level</div><div class="line">        tableView.rowHeight = <span class="type">UITableViewAutomaticDimension</span></div><div class="line">        tableView.estimatedRowHeight = <span class="number">40</span></div><div class="line">        tableView.tableFooterView = <span class="type">UIView</span>()</div><div class="line">        tableView.showsVerticalScrollIndicator = <span class="literal">false</span></div><div class="line">        tableView.separatorColor = <span class="type">UIColor</span>(white: <span class="number">0.9</span>, alpha: <span class="number">1.0</span>)</div><div class="line">        tableView.separatorInset = <span class="type">UIEdgeInsetsMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</div><div class="line">        tableView.dataSource = <span class="keyword">self</span></div><div class="line">        tableView.delegate = <span class="keyword">self</span></div><div class="line">        </div><div class="line">        menuTableViews.append(tableView)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    configureLayout()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å¸ƒå±€table view</span></div><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">configureLayout</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">self</span>.addSubview(containerView)</div><div class="line">    <span class="keyword">for</span> (index, tableView) <span class="keyword">in</span> menuTableViews.enumerated() &#123;</div><div class="line">        containerView.addSubview(tableView)</div><div class="line">        </div><div class="line">        tableView.snp.makeConstraints(&#123; (make) <span class="keyword">in</span></div><div class="line">            make.top.bottom.equalToSuperview()</div><div class="line">            make.width.equalToSuperview().multipliedBy(<span class="number">1.0</span> / <span class="type">Double</span>(<span class="keyword">self</span>.numberOfLvel))</div><div class="line">            </div><div class="line">            <span class="keyword">if</span> index == <span class="number">0</span> &#123;</div><div class="line">                make.leading.equalToSuperview()</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                make.leading.equalTo(<span class="keyword">self</span>.menuTableViews[index - <span class="number">1</span>].snp.trailing)</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    containerView.snp.makeConstraints &#123; (make) <span class="keyword">in</span></div><div class="line">        make.leading.top.trailing.equalToSuperview()</div><div class="line">        make.height.equalTo(<span class="number">240</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åˆ›å»ºtable viewè¿™ä¸ªæ–¹æ³•å¾ˆå¥½æ‡‚ï¼Œåœ¨è¿™é‡Œå¯¹table viewåšäº†ä¸€äº›å¸¸è§„çš„é…ç½®ï¼Œç”±äºæˆ‘ä»¬è¿˜æ²¡æœ‰å®ç°UITableViewçš„æ•°æ®æºæ–¹æ³•å’Œdelegateæ–¹æ³•ï¼Œè¿™é‡Œç¼–è¯‘å™¨ä¼šæœ‰é”™è¯¯æç¤ºï¼Œè¿™ä¸ªä¸è¦ç´§ï¼Œæˆ‘ä»¬åé¢åŠ ä¸Šå»ã€‚</p>
<p>åœ¨å¸ƒå±€table viewçš„æ–¹æ³•ä¸­ï¼Œä¸ºæ¯ä¸ªtable viewæ·»åŠ çº¦æŸï¼Œtable viewçš„topå’Œbottomå’ŒcontainerViewä¸€è‡´ï¼›widthä¸ºcontainerViewçš„<font color="#FF8C00">1.0 / numberOfLvel</font>ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæœ‰3ä¸ªçº§åˆ«ï¼Œé‚£ä¹ˆæ¯ä¸ªåˆ—è¡¨çš„å®½åº¦ä¸ºcontainerViewçš„<font color="#FF8C00">1/3</font>ï¼›table viewçš„å·¦è¾¹çš„çº¦æŸè®¾ç½®ä¸containerViewçš„å·¦è¾¹ç›¸ç­‰æˆ–è€…ä¸å‰ä¸€çº§åˆ—è¡¨çš„å³è¾¹ç›¸ç­‰ã€‚æœ€åè®¾ç½®containerViewçš„å·¦è¾¹ï¼Œä¸Šè¾¹ï¼Œå³è¾¹çº¦æŸä¸MultiLevelMenuå¯¹è±¡æœ¬èº«ç›¸ç­‰ï¼Œheightçº¦æŸä¸º240ï¼Œè¿™ä¸ªå¯ä»¥æ ¹æ®éœ€è¦æ”¹å˜ã€‚å¸Œæœ›æˆ‘æœ‰è§£é‡Šæ¸…æ¥šè¿™ä¸ªæ–¹æ³•ğŸ˜‚ğŸ˜‚ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬ä½¿ç”¨<font color="#FF8C00">extension</font>çš„æ–¹å¼ä¸ºMultiLevelMenuæ·»åŠ UITableViewçš„æ•°æ®æºæ–¹æ³•å’Œdelegateæ–¹æ³•ã€‚åœ¨MultiLevelMenuç±»æœ€åçš„èŠ±æ‹¬å·ä¸‹é¢æ·»åŠ ä»¥ä¸‹ä»£ç æ®µã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MultiLevelMenu</span>: <span class="title">UITableViewDataSource</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">5</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span> &#123;</div><div class="line">        <span class="keyword">let</span> level = tableView.tag - <span class="number">100</span></div><div class="line">        <span class="keyword">let</span> cell = tableView.dequeueReusableCell(withIdentifier: <span class="type">LevelItemCellReuseIdentifier</span>, <span class="keyword">for</span>: indexPath) <span class="keyword">as</span>! <span class="type">LevelItemCell</span></div><div class="line">        cell.levelNamelabel.text = <span class="string">"level <span class="subst">\(level)</span>-<span class="subst">\(indexPath.row)</span>"</span></div><div class="line">        <span class="keyword">return</span> cell</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MultiLevelMenu</span>: <span class="title">UITableViewDelegate</span> </span>&#123;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬æ·»åŠ è¿™ä¸¤æ®µä»£ç çº¯ç²¹æ˜¯ä¸ºäº†éªŒè¯èƒ½å¦å°†MultiLevelMenuæ­£ç¡®çš„å±•ç¤ºå‡ºæ¥ã€‚</p>
<p>æˆ‘ä»¬ä¸ºMultiLevelMenuçš„dataSourceå±æ€§æ·»åŠ ä¸€ä¸ªå±æ€§è§‚å¯Ÿå™¨ï¼Œå½“dataSourceè¢«è®¾ç½®ä¹‹åï¼Œæˆ‘ä»¬å°±è°ƒç”¨æ•°æ®æºæ–¹æ³•<font color="#FF8C00">numberOfLevel(of multiLevelMenu: MultiLevelMenu)</font>ï¼Œè·å¾—éœ€è¦å±•ç¤ºå¤šå°‘ä¸ªçº§åˆ«çš„ä¿¡æ¯å¹¶åˆ›å»ºtable viewã€‚ä»£ç å¦‚ä¸‹</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">weak</span> <span class="keyword">var</span> dataSource: <span class="type">MultiLevelMenuDataSource</span>? &#123;</div><div class="line">    <span class="keyword">didSet</span> &#123;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> dataSource = dataSource <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        numberOfLvel = dataSource.numberOfLevel(of: <span class="keyword">self</span>)</div><div class="line">        createMenuTableView()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸ºäº†æœ‰ä¸ªå‚è€ƒï¼Œè´´å‡ºåˆ°ç›®å‰ä¸ºæ­¢æ•´ä¸ªMultiLevelMenu.swiftæ–‡ä»¶çš„ä»£ç ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="meta">@objc</span> <span class="class"><span class="keyword">protocol</span> <span class="title">MultiLevelMenuDataSource</span>: <span class="title">NSObjectProtocol</span> </span>&#123;</div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">numberOfLevel</span><span class="params">(of multiLevelMenu: MultiLevelMenu)</span></span> -&gt; <span class="type">Int</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">fileprivate</span> <span class="class"><span class="keyword">class</span> <span class="title">LevelItemCell</span>: <span class="title">UITableViewCell</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> levelNamelabel: <span class="type">UILabel</span> = &#123;</div><div class="line">        <span class="keyword">let</span> label = <span class="type">UILabel</span>()</div><div class="line">        label.font = <span class="type">UIFont</span>.systemFont(ofSize: <span class="number">14</span>)</div><div class="line">        label.textAlignment = .center</div><div class="line">        <span class="keyword">return</span> label</div><div class="line">    &#125;()</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(style: <span class="type">UITableViewCellStyle</span>, reuseIdentifier: <span class="type">String</span>?) &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(style: style, reuseIdentifier: reuseIdentifier)</div><div class="line">        <span class="keyword">self</span>.backgroundColor = <span class="type">UIColor</span>.clear</div><div class="line">        </div><div class="line">        <span class="comment">// å¸ƒå±€label</span></div><div class="line">        <span class="keyword">self</span>.contentView.addSubview(levelNamelabel)</div><div class="line">        levelNamelabel.snp.makeConstraints &#123; (make) <span class="keyword">in</span></div><div class="line">            make.edges.equalToSuperview().inset(<span class="type">UIEdgeInsetsMake</span>(<span class="number">8</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">12</span>))</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// æ·»åŠ ç´«è‰²é€‰ä¸­æ•ˆæœ</span></div><div class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</div><div class="line">        view.backgroundColor = <span class="type">UIColor</span>(red: <span class="number">198</span> / <span class="number">255.0</span>, green: <span class="number">165</span> / <span class="number">255.0</span>, blue: <span class="number">223</span> / <span class="number">255.0</span>, alpha: <span class="number">0.3</span>)</div><div class="line">        <span class="keyword">self</span>.selectedBackgroundView = view</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">        <span class="built_in">fatalError</span>(<span class="string">"init(coder:) has not been implemented"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MultiLevelMenu</span>: <span class="title">UIView</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">//MARK: - å…¬å¼€å˜é‡</span></div><div class="line">    <span class="keyword">weak</span> <span class="keyword">var</span> dataSource: <span class="type">MultiLevelMenuDataSource</span>? &#123;</div><div class="line">        <span class="keyword">didSet</span> &#123;</div><div class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> dataSource = dataSource <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span></div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            numberOfLvel = dataSource.numberOfLevel(of: <span class="keyword">self</span>)</div><div class="line">            createMenuTableView()</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//MARK: - ç§æœ‰å˜é‡</span></div><div class="line">    <span class="keyword">fileprivate</span> <span class="keyword">let</span> <span class="type">LevelItemCellReuseIdentifier</span> = <span class="string">"LevelItemCellReuseIdentifier"</span></div><div class="line">    <span class="keyword">fileprivate</span> <span class="built_in">lazy</span> <span class="keyword">var</span> numberOfLvel = <span class="number">0</span></div><div class="line">    <span class="keyword">fileprivate</span> <span class="built_in">lazy</span> <span class="keyword">var</span> menuTableViews = [<span class="type">UITableView</span>]()</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="built_in">lazy</span> <span class="keyword">var</span> containerView: <span class="type">UIView</span> = &#123;</div><div class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</div><div class="line">        <span class="keyword">return</span> view</div><div class="line">    &#125;()</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</div><div class="line">        <span class="keyword">self</span>.backgroundColor = <span class="type">UIColor</span>(white: <span class="number">0</span>, alpha: <span class="number">0.5</span>)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">        <span class="built_in">fatalError</span>(<span class="string">"init(coder:) has not been implemented"</span>)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// åˆ›å»ºtable view</span></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">createMenuTableView</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">for</span> level <span class="keyword">in</span> <span class="number">0</span>..&lt;<span class="keyword">self</span>.numberOfLvel &#123;</div><div class="line">            <span class="keyword">let</span> tableView = <span class="type">UITableView</span>()</div><div class="line">            tableView.register(<span class="type">LevelItemCell</span>.<span class="keyword">self</span>, forCellReuseIdentifier: <span class="type">LevelItemCellReuseIdentifier</span>)</div><div class="line">            tableView.tag = <span class="number">100</span> + level</div><div class="line">            tableView.rowHeight = <span class="type">UITableViewAutomaticDimension</span></div><div class="line">            tableView.estimatedRowHeight = <span class="number">40</span></div><div class="line">            tableView.tableFooterView = <span class="type">UIView</span>()</div><div class="line">            tableView.showsVerticalScrollIndicator = <span class="literal">false</span></div><div class="line">            tableView.separatorColor = <span class="type">UIColor</span>(white: <span class="number">0.9</span>, alpha: <span class="number">1.0</span>)</div><div class="line">            tableView.separatorInset = <span class="type">UIEdgeInsetsMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</div><div class="line">            tableView.dataSource = <span class="keyword">self</span></div><div class="line">            tableView.delegate = <span class="keyword">self</span></div><div class="line">            </div><div class="line">            menuTableViews.append(tableView)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        configureLayout()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// å¸ƒå±€table view</span></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">configureLayout</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">self</span>.addSubview(containerView)</div><div class="line">        <span class="keyword">for</span> (index, tableView) <span class="keyword">in</span> menuTableViews.enumerated() &#123;</div><div class="line">            containerView.addSubview(tableView)</div><div class="line">            </div><div class="line">            tableView.snp.makeConstraints(&#123; (make) <span class="keyword">in</span></div><div class="line">                make.top.bottom.equalToSuperview()</div><div class="line">                make.width.equalToSuperview().multipliedBy(<span class="number">1.0</span> / <span class="type">Double</span>(<span class="keyword">self</span>.numberOfLvel))</div><div class="line">                </div><div class="line">                <span class="keyword">if</span> index == <span class="number">0</span> &#123;</div><div class="line">                    make.leading.equalToSuperview()</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    make.leading.equalTo(<span class="keyword">self</span>.menuTableViews[index - <span class="number">1</span>].snp.trailing)</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        containerView.snp.makeConstraints &#123; (make) <span class="keyword">in</span></div><div class="line">            make.leading.top.trailing.equalToSuperview()</div><div class="line">            make.height.equalTo(<span class="number">240</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MultiLevelMenu</span>: <span class="title">UITableViewDataSource</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">5</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span> &#123;</div><div class="line">        <span class="keyword">let</span> level = tableView.tag - <span class="number">100</span></div><div class="line">        <span class="keyword">let</span> cell = tableView.dequeueReusableCell(withIdentifier: <span class="type">LevelItemCellReuseIdentifier</span>, <span class="keyword">for</span>: indexPath) <span class="keyword">as</span>! <span class="type">LevelItemCell</span></div><div class="line">        cell.levelNamelabel.text = <span class="string">"level <span class="subst">\(level)</span>-<span class="subst">\(indexPath.row)</span>"</span></div><div class="line">        <span class="keyword">return</span> cell</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">MultiLevelMenu</span>: <span class="title">UITableViewDelegate</span> </span>&#123;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¥ç€æˆ‘ä»¬åˆ‡æ¢åˆ°<font color="#FF8C00">HomeViewController.swift</font>æ–‡ä»¶ï¼Œå¯¹MultiLevelMenuåšä¸ªç®€å•çš„å±•ç¤ºéªŒè¯ã€‚åœ¨<font color="#FF8C00">createSeparateLine()</font>æ–¹æ³•ä¸‹æ–¹æ·»åŠ ä¸€ä¸ª<font color="#FF8C00">presentMultiLevelMunu(sender: UIButton)</font>æ–¹æ³•ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@objc</span> <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">presentMultiLevelMunu</span><span class="params">(sender: UIButton)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> multiLevelMenu = <span class="type">MultiLevelMenu</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">120</span>, width: <span class="keyword">self</span>.view.frame.width, height: <span class="number">500</span>))</div><div class="line">    multiLevelMenu.dataSource = <span class="keyword">self</span></div><div class="line">    <span class="keyword">self</span>.view.addSubview(multiLevelMenu)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰¾åˆ°cityButtonå®šä¹‰çš„åœ°æ–¹ï¼Œç”¨ä¸‹é¢çš„ä»£ç æ®µæ›¿æ¢å®ƒã€‚ç‚¹å‡»cityButtonå°†ä¼šå±•ç¤ºMultiLevelMenuã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="built_in">lazy</span> <span class="keyword">var</span> cityButton: <span class="type">UIButton</span> = &#123;</div><div class="line">    <span class="keyword">let</span> button = <span class="keyword">self</span>.createButton(title: <span class="string">"åŸå¸‚"</span>)</div><div class="line">    button.addTarget(<span class="keyword">self</span>, action: #selector(presentMultiLevelMunu(sender:)), <span class="keyword">for</span>: .touchUpInside)</div><div class="line">    <span class="keyword">return</span> button</div><div class="line">&#125;()</div></pre></td></tr></table></figure>
<p>æœ€åå®ç°MultiLevelMenuçš„æ•°æ®æºæ–¹æ³•ï¼Œå‘Šè¯‰MultiLevelMenuéœ€è¦å±•ç¤ºå¤šå°‘çº§æ•°æ®ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">HomeViewController</span>: <span class="title">MultiLevelMenuDataSource</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">numberOfLevel</span><span class="params">(of multiLevelMenu: MultiLevelMenu)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">3</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ğŸ¶æ¿€åŠ¨äººå¿ƒçš„æ—¶åˆ»æ¥å•¦ï¼Œè¿è¡Œä¸€æ¬¡çœ‹çœ‹æ•ˆæœğŸ¹ã€‚ç‚¹å‡»åŸå¸‚æŒ‰é’®ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»å°†MultiLevelMenuå±•ç¤ºå‡ºæ¥äº†ğŸµğŸ¼ã€‚</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/%E6%95%88%E6%9E%9C1.png?imageView2/2/w/375" alt=""></p>
<p>è¿™é‡Œæˆ‘ä»¬æ˜¯ç›´æ¥æŠŠMultiLevelMenuæ·»åŠ åˆ°å½“å‰controllerçš„viewä¸Šçš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¢ä¸€ç§æ–¹å¼æ¥å±•ç¤ºMultiLevelMenuï¼Œåœ¨UIWindowä¸Šæ·»åŠ MultiLevelMenuã€‚åˆ‡æ¢åˆ°<font color="#FF8C00">MultiLevelMenu.swift</font>æ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ªå˜é‡ç”¨æ¥è®°å½•MultiLevelMenuæ˜¯å¦å·²ç»å¼¹å‡ºï¼Œå†æ·»åŠ ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨æ¥å¼¹å‡ºå’Œç§»é™¤MultiLevelMenuã€‚</p>
<blockquote>
<ul>
<li>func presnt(from view: UIView)ï¼Œä»ä¸€ä¸ªviewçš„ä¸‹æ–¹å¼¹å‡ºMultiLevelMenuï¼Œæ¯”å¦‚ä¼ è¿›æ¥ä¸€ä¸ªbuttonï¼Œé‚£ä¹ˆå°†åœ¨è¿™ä¸ªbuttonçš„ä¸‹æ–¹æ˜¾ç¤ºMultiLevelMenuæ§ä»¶ã€‚</li>
<li>func dismiss(animated: Bool) å°†MultiLevelMenuæ§ä»¶ä»UIWindowç§»é™¤ã€‚</li>
<li>var isShowed = falseï¼Œè®°å½•MultiLevelMenuçš„æ˜¾ç¤ºçŠ¶æ€</li>
</ul>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">presnt</span><span class="params">(from view: UIView)</span></span> &#123;</div><div class="line">    <span class="keyword">var</span> tmpSuperView = view</div><div class="line">    </div><div class="line">    <span class="comment">// å¯»æ‰¾æœ€ä¸Šçº§view</span></div><div class="line">    <span class="keyword">while</span> tmpSuperView.superview != <span class="literal">nil</span> &#123;</div><div class="line">        tmpSuperView = tmpSuperView.superview!</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> window = <span class="type">UIApplication</span>.shared.keyWindow</div><div class="line">    window?.addSubview(<span class="keyword">self</span>)</div><div class="line">    </div><div class="line">    <span class="comment">// è¿›è¡Œåæ ‡å˜åŒ–ï¼Œå¾—åˆ°æ§ä»¶å·¦ä¸‹è§’ç›¸å¯¹äºæœ€ä¸Šçº§viewçš„åæ ‡</span></div><div class="line">    <span class="keyword">var</span> presentPoint: <span class="type">CGPoint</span></div><div class="line">    <span class="keyword">if</span> view.superview == tmpSuperView &#123;</div><div class="line">         presentPoint = <span class="type">CGPoint</span>(x: view.frame.minX, y: view.frame.maxY)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">         presentPoint = tmpSuperView.convert(<span class="type">CGPoint</span>(x: view.frame.minX, y: view.frame.maxY), from: view)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">self</span>.snp.makeConstraints &#123; (make) <span class="keyword">in</span></div><div class="line">        make.top.equalToSuperview().offset(presentPoint.y)</div><div class="line">        make.leading.trailing.bottom.equalToSuperview()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    isShowed = <span class="literal">true</span></div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">dismiss</span><span class="params">(animated: Bool)</span></span> &#123;</div><div class="line">    <span class="keyword">self</span>.removeFromSuperview()</div><div class="line">    isShowed = <span class="literal">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰å¿…è¦å¯¹func presnt(from view: UIView)è§£é‡Šä¸€ä¸‹ï¼Œä¼ è¿›æ¥ä¸€ä¸ªviewï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å®ƒæœ€ä¸Šçº§çš„view(ä¹Ÿå°±æ˜¯superView)ï¼Œæ¯”å¦‚ä¸‹é¢çš„ç¤ºä¾‹å›¾ï¼Œview2å’Œview3çš„æœ€ä¸Šçº§viewéƒ½æ˜¯view1ï¼Œè¿™é‡Œå°±æ¶‰åŠäº†ä¸€ä¸ªåæ ‡ç³»é—®é¢˜ï¼Œview3çš„åæ ‡æ˜¯ç›¸å¯¹äºview2ï¼Œè€Œview2çš„åæ ‡æ˜¯ç›¸å¯¹äºview1çš„ã€‚å‡å¦‚æˆ‘ä»¬ç°åœ¨ä»view3å¼¹å‡ºMultiLevelMenuï¼Œé‚£ä¹ˆå°±éœ€è¦å°†view3çš„åæ ‡å˜æ¢åˆ°view1çš„åæ ‡ç³»ä¸­ï¼Œå¦‚æœä»view2å¼¹å‡ºMultiLevelMenuï¼Œåˆ™ä¸éœ€è¦è¿›è¡Œåæ ‡å˜æ¢ï¼Œå› ä¸ºview2çš„åæ ‡æœ¬èº«å°±æ˜¯ç›¸å¯¹äºview1çš„ã€‚</p>
<p>æˆ‘ä»¬åœ¨func presnt(from view: UIView)æ–¹æ³•ä¸­å°†MultiLevelMenuæ·»åŠ åˆ°windowä¸Šï¼Œå¯¹MultiLevelMenuæ·»åŠ çº¦æŸï¼Œä½¿MultiLevelMenuæ˜¾ç¤ºçš„ä½ç½®åˆšå¥½åœ¨ä¼ è¿›æ¥viewçš„ä¸‹æ–¹ï¼Œå¹¶å æ»¡å‰©ä½™çš„ç©ºé—´ã€‚</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/iPhone%207.png?imageView2/2/w/375" alt=""></p>
<p>åˆ‡æ¢åˆ°<font color="#FF8C00">HomeViewController.swift</font>æ–‡ä»¶ï¼Œè®©æˆ‘ä»¬æ¥è¯•è¯•ï¼Œåˆšåˆšæ·»åŠ çš„æ–¹æ³•ã€‚</p>
<p>åœ¨viewDidLoad()æ–¹æ³•çš„ä¸Šæ–¹æ·»åŠ ä¸€ä¸ªMultiLevelMenuçš„ç¤ºä¾‹å˜é‡ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="built_in">lazy</span> <span class="keyword">var</span> multiLevelMenu: <span class="type">MultiLevelMenu</span> = &#123;</div><div class="line">    <span class="keyword">let</span> multiLevelMenu = <span class="type">MultiLevelMenu</span>()</div><div class="line">    multiLevelMenu.dataSource = <span class="keyword">self</span></div><div class="line">    <span class="keyword">return</span> multiLevelMenu</div><div class="line">&#125;()</div></pre></td></tr></table></figure>
<p>æ¥ç€æˆ‘ä»¬ä¿®æ”¹<font color="#FF8C00">presentMultiLevelMunu(sender: UIButton)</font>æ–¹æ³•ï¼Œå¦‚æœMultiLevelMenuæ²¡æœ‰å¼¹å‡ºï¼Œæˆ‘ä»¬å°±æ˜¾ç¤ºå®ƒï¼Œå¦‚æœå·²ç»æ˜¾ç¤ºï¼Œæˆ‘ä»¬å°±ç§»é™¤å®ƒã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@objc</span> <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">presentMultiLevelMunu</span><span class="params">(sender: UIButton)</span></span> &#123;</div><div class="line">    multiLevelMenu.isShowed ? multiLevelMenu.dismiss(animated: <span class="literal">true</span>) : multiLevelMenu.presnt(from: sender)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿è¡Œä¸€éè¯•è¯•å§ğŸ˜ğŸ˜ï¼æˆ‘ä»¬æ­£ç¡®çš„å°†MultiLevelMenuï¼Œæ˜¾ç¤ºåœ¨cityButtonçš„ä¸‹æ–¹ï¼Œè€Œä¸”æ˜¾ç¤ºï¼Œç§»é™¤éƒ½æ²¡æœ‰é—®é¢˜ã€‚</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/%E6%95%88%E6%9E%9C3.png?imageView2/2/w/375" alt=""></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä¸ºMultiLevelMenuï¼Œå¡«å……ç‚¹çœŸå®çš„æ•°æ®äº†ï¼Œè¿™éƒ¨åˆ†æ‰æ˜¯æˆ‘ä»¬çœŸæ­£çš„é‡ç‚¹ï¼Œæ‰€ä»¥æ‰“èµ·ç²¾ç¥å§å°‘å¹´ï¼ï¼ã€‚</p>
<p>çœ‹çœ‹æˆ‘ä»¬æ¯ä¸€çº§çš„table viewéœ€è¦æ˜¾ç¤ºä»€ä¹ˆæ•°æ®ï¼Œå¯ä»¥å‘ç°åªè¦æ˜¾ç¤ºæŸä¸ªlevelçš„åç§°å°±å¤Ÿäº†ï¼Œé€‰ä¸­ä¸€ä¸ªlevelå°±ä¼šæ˜¾ç¤ºæ‰€æœ‰ä¸‹ä¸€çº§çš„åç§°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªLevelç±»ï¼Œæ¥ä»£è¡¨æ¯ä¸€ä¸ªéœ€è¦æ˜¾ç¤ºçš„LevelèŠ‚ç‚¹ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Level</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> levelName = <span class="string">""</span></div><div class="line">    <span class="keyword">var</span> netLevelItems: [<span class="type">Level</span>]?</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥è®©å…·ä½“çš„Modelå»ç»§æ‰¿Levelç±»ï¼Œåœ¨MultiLevelMenuçš„ä½¿ç”¨ä¸Šåªéœ€è¦çŸ¥é“levelNameå’Œå¯¹åº”çš„ä¸‹ä¸€çº§å°±å¤Ÿäº†ï¼Œæ‰€ä»¥MultiLevelMenuèƒ½å¤ŸæŠŠLevelç±»æˆ–è€…å®ƒçš„å­ç±»ä½œä¸ºè‡ªå·±çš„æ•°æ®æºã€‚</p>
<p>ä¸ºäº†è·µè¡Œé¢å‘åè®®ç¼–ç¨‹çš„æ€æƒ³ï¼Œè¿™é‡Œä¸ä½¿ç”¨ç»§æ‰¿çš„æ–¹å¼å®ç°MultiLevelMenuçš„æ•°æ®æºç»“æ„ï¼Œè€Œå°†Levelç±»ä»¥åè®®çš„æ–¹å¼å®ç°ã€‚åœ¨Viewè¿™ä¸ªgroupä¸­æ–°å»ºä¸€ä¸ªswiftæ–‡ä»¶ï¼Œå‘½åä¸º<font color="#FF8C00"> LeveItemProtocol.swift</font>ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰LeveItemProtocolã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"></div><div class="line"><span class="meta">@objc</span> <span class="class"><span class="keyword">protocol</span> <span class="title">LeveItemProtocol</span>: <span class="title">NSObjectProtocol</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> levelName: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</div><div class="line">    <span class="keyword">var</span> nextLevelItems: [<span class="type">LeveItemProtocol</span>]? &#123; <span class="keyword">get</span> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>LeveItemProtocolå®šä¹‰äº†ä¸¤ä¸ªå±æ€§ï¼Œå½“å‰çº§åˆ«çš„åç§°å’Œä¸‹ä¸€çº§åˆ«ï¼Œå¦‚æœå½“å‰çº§åˆ«æ˜¯æœ€åä¸€çº§ï¼Œé‚£ä¹ˆä¸‹ä¸€çº§å°±æ˜¯nilï¼Œæ‰€ä»¥ä¸‹ä¸€çº§æ˜¯optionalç±»å‹çš„ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªModelï¼Œç”¨æ¥è¡¨ç¤ºåŸå¸‚ä¿¡æ¯ã€‚æ‰“å¼€Resourcesè¿™ä¸ªgroupä¸­çš„china-city-info.jsonæ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å¤§é‡çš„jsonæ ¼å¼çš„åŸå¸‚ä¿¡æ¯æ•°æ®ï¼Œè¿™é‡Œä¼šä½¿ç”¨åˆ°Unboxç¬¬ä¸‰æ–¹åº“å°†JSONæ•°æ®è½¬ä¸ºæ¨¡å‹ã€‚</p>
<p>åœ¨Modelè¿™ä¸ªgroupä¸­æ–°å»ºä¸€ä¸ªswiftæ–‡ä»¶ï¼Œå‘½åä¸º<font color="#FF8C00">CityModel.swift</font>ï¼Œå°†æ–‡ä»¶å†…å®¹æ›¿æ¢ä¸ºä¸‹é¢çš„ä»£ç æ®µã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"><span class="keyword">import</span> Unbox</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CityModel</span>: <span class="title">NSObject</span>, <span class="title">Unboxable</span>, <span class="title">LeveItemProtocol</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> name: <span class="type">String</span></div><div class="line">    <span class="keyword">let</span> subCitys: [<span class="type">CityModel</span>]?</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> levelName: <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.name</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> nextLevelItems: [<span class="type">LeveItemProtocol</span>]? &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.subCitys</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>(unboxer: <span class="type">Unboxer</span>) <span class="keyword">throws</span> &#123;</div><div class="line">        name = <span class="keyword">try</span> unboxer.unbox(key: <span class="string">"name"</span>)</div><div class="line">        subCitys = unboxer.unbox(key: <span class="string">"sub"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç®€å•çš„è¯´æ˜ä¸€ä¸‹è¿™ä¸ªmodelï¼Œè¿™é‡Œç»§æ‰¿NSObjectçš„åŸå› æ˜¯ï¼ŒLeveItemProtocolç»§æ‰¿äº†NSObjectProtocolï¼Œè€ŒNSObjectå¯¹NSObjectProtocolæä¾›äº†é»˜è®¤å®ç°ï¼Œç»§æ‰¿äº†NSObjectä¹Ÿå°±æ»¡è¶³äº†NSObjectProtocolçš„è¦æ±‚ï¼›Unboxableåè®®ç”¨æ¥jsonè½¬modelï¼ŒLeveItemProtocolå¯ä»¥è®©CityModelåšä¸ºMultiLevelMenuçš„æ•°æ®æºã€‚å¯¹äºLeveItemProtocolçš„å®ç°ï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¯è¿”å›å½“å‰åŸå¸‚åç§°å’Œä¸‹ä¸€çº§åŸå¸‚ã€‚å®é™…ä¸­å¯èƒ½æ¯ä¸ªé¡¹ç›®çš„modelä¼šå’Œè¿™é‡Œçš„æœ‰å¾ˆå¤§å·®åˆ«ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œè°ƒæ•´ã€‚</p>
<p>åœ¨ViewModelè¿™ä¸ªgroupä¸­ï¼Œåˆ›å»ºä¸€ä¸ªCityViewModel.swiftæ–‡ä»¶ï¼Œæˆ‘ä»¬å°†åœ¨è¿™é‡ŒæŠŠjsonæ•°æ®è½¬æˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„modelï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"><span class="keyword">import</span> Unbox</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CityViewModel</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> cityArray: [<span class="type">CityModel</span>]? = <span class="keyword">self</span>.convertJSONDataToCityModel()</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">convertJSONDataToCityModel</span><span class="params">()</span></span> -&gt; [<span class="type">CityModel</span>]? &#123;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> filePath = <span class="type">Bundle</span>.main.url(forResource: <span class="string">"china-city-info"</span>, withExtension: <span class="string">"json"</span>),</div><div class="line">            <span class="keyword">let</span> data = <span class="keyword">try</span>? <span class="type">Data</span>(contentsOf: filePath) <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="keyword">let</span> cityArray: [<span class="type">CityModel</span>] = <span class="keyword">try</span> unbox(data: data)</div><div class="line">            <span class="keyword">return</span> cityArray</div><div class="line">        &#125; <span class="keyword">catch</span> &#123;</div><div class="line">            <span class="built_in">print</span>(error.localizedDescription)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸€ä¸ªå¯¹å¤–å…¬å¼€çš„æ‡’æƒ°å˜é‡ï¼Œé€šè¿‡è¿™ä¸ªå˜é‡è·å–åˆ°åŸå¸‚æ•°ç»„ã€‚å®é™…å·¥ä½œç”±<font color="#FF8C00">func convertJSONDataToCityModel()</font>æ–¹æ³•å®Œæˆï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¾—åˆ°åŸå¸‚æ•°æ®æ–‡ä»¶çš„è·¯å¾„ï¼Œå†ç”¨Dataçš„åˆå§‹åŒ–æ–¹æ³•å¾—åˆ°Dataç±»å‹çš„æ•°æ®ï¼Œæœ€åä½¿ç”¨unboxçš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå°†jsonæ•°æ®è½¬åŒ–ä¸ºåŸå¸‚æ•°ç»„ã€‚åœ¨è·¯å¾„é”™è¯¯ï¼Œæˆ–è€…è½¬æ¢å¤±è´¥çš„æƒ…å†µä¸‹éƒ½ä¼šè¿”å›nilã€‚</p>
<p>ç°åœ¨æ¥çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦æ­£ç¡®çš„è·å–åˆ°äº†åŸå¸‚æ•°æ®ï¼Œåˆ‡æ¢åˆ°HomeViewController.swiftæ–‡ä»¶ï¼Œåœ¨<font color="#FF8C00">viewDidLoad()</font>æ–¹æ³•çš„æœ€åæ·»åŠ ä¸¤è¡Œä»£ç ï¼Œå¹¶åœ¨æœ€åçš„èŠ±æ‹¬å·ä¸­æ‰“ä¸ªæ–­ç‚¹ã€‚</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/code1.png" alt=""></p>
<p>è¿è¡Œåˆ°æ–­ç‚¹å¤„ï¼ŒæŸ¥çœ‹æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç¡®å®æ­£ç¡®çš„è·å¾—äº†åŸå¸‚æ•°æ®ã€‚</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/code2.png" alt=""></p>
<p>åˆ æ‰åˆšåˆšæ·»åŠ çš„ä¸¤è¡Œä»£ç å’Œæ–­ç‚¹ã€‚æ¥ç€æˆ‘ä»¬åˆ‡æ¢åˆ°MultiLevelMenu.swiftæ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸º<font color="#FF8C00">MultiLevelMenuDataSource</font>å£°æ˜ä¸€ä¸ªæ–°çš„æ•°æ®æ–¹æ³•<font color="#FF8C00">func firstLevelItems(of multiLevelMenu: MultiLevelMenu) -&gt; [LeveItemProtocol]?</font>ï¼ŒMultiLevelMenuå°†é€šè¿‡è¿™ä¸ªæ•°æ®æºæ–¹æ³•è·å¾—çœŸæ­£å±•ç¤ºçš„æ•°æ®ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@objc</span> <span class="class"><span class="keyword">protocol</span> <span class="title">MultiLevelMenuDataSource</span>: <span class="title">NSObjectProtocol</span> </span>&#123;</div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">numberOfLevel</span><span class="params">(of multiLevelMenu: MultiLevelMenu)</span></span> -&gt; <span class="type">Int</span></div><div class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">firstLevelItems</span><span class="params">(of multiLevelMenu: MultiLevelMenu)</span></span> -&gt; [<span class="type">LeveItemProtocol</span>]?</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»æ–¹æ³•åå¯ä»¥å¤§æ¦‚çŸ¥é“ï¼Œè¿™ä¸ªæ–¹æ³•è®©å¤–ç•Œè¿”å›éœ€è¦å±•ç¤ºçš„ç¬¬ä¸€çº§æ•°æ®ï¼Œä¸ºä»€ä¹ˆåªè¦ç¬¬ä¸€æ•°æ®å°±å¤Ÿäº†å‘¢ï¼Ÿï¼Ÿå› ä¸ºè¿™é‡Œçš„æ¯ä¸€çº§æ•°æ®éƒ½å®ç°äº†LeveItemProtocolï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡nextLevelItemså±æ€§æ¥å¾—åˆ°ä¸‹ä¸€çº§éœ€è¦å±•ç¤ºçš„æ•°æ®ã€‚</p>
<p>åœ¨æˆ‘ä»¬å£°æ˜è¿™ä¸ªæ•°æ®æºæ–¹æ³•çš„åŒæ—¶ï¼ŒXcodeä¹ŸæŠ¥é”™äº†ï¼Œå‘Šè¯‰æˆ‘ä»¬HomeViewControlleræ²¡æœ‰éµå®ˆMultiLevelMenuDataSourceåè®®ã€‚é‚£æˆ‘ä»¬å°±å›åˆ°HomeViewController.swiftæ–‡ä»¶ï¼Œå®ç°è¿™ä¸ªæ•°æ®æºæ–¹æ³•ã€‚åœ¨HomeViewControllerçš„extensionéƒ¨åˆ†ï¼Œæ·»åŠ è¿™ä¸ªæ•°æ®æºæ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è¿”å›é€šè¿‡CityViewModelå¾—åˆ°çš„åŸå¸‚æ•°ç»„æ•°æ®ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">firstLevelItems</span><span class="params">(of multiLevelMenu: MultiLevelMenu)</span></span> -&gt; [<span class="type">LeveItemProtocol</span>]? &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">CityViewModel</span>().cityArray</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨å›åˆ°MultiLevelMenu.swiftæ–‡ä»¶ï¼Œä¸ºMultiLevelMenuç±»æ·»åŠ ä»¥ä¸‹ä¸¤ä¸ªå±æ€§ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">fileprivate</span> <span class="keyword">var</span> firstLevelItems: [<span class="type">LeveItemProtocol</span>]?</div><div class="line"><span class="keyword">fileprivate</span> <span class="built_in">lazy</span> <span class="keyword">var</span> selectedLevelItems = [<span class="type">LeveItemProtocol</span>?]()</div></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>firstLevelItems è®°å½•ç¬¬ä¸€çº§æ•°æ®ï¼Œé€šè¿‡ç¬¬ä¸€çº§æ•°æ®å¯ä»¥è·å–åç»­çº§åˆ«çš„æ•°æ®ï¼Œæ‰€åŠæˆ‘ä»¬å¯¹ç¬¬ä¸€çº§æ•°æ®åšä¸€ä¸ªå¼•ç”¨</li>
<li>selectedLevelItems è®°å½•é€‰ä¸­çš„çº§åˆ«é¡¹ï¼Œæ¯”å¦‚é€‰ä¸­åŒ—äº¬ï¼Œæµ·æ·€åŒºï¼Œé‚£ä¹ˆç¬¬ä¸€é¡¹æ˜¯åŒ—äº¬ï¼Œç¬¬äºŒé¡¹æ˜¯æµ·æ·€åŒºï¼Œå¯¹åº”åŸå¸‚çš„ç¬¬ä¸€çº§å’Œç¬¬äºŒçº§ã€‚</li>
</ul>
</blockquote>
<p>ç°åœ¨å‡è®¾æˆ‘ä»¬çš„MultiLevelMenuå·²ç»å¾—åˆ°äº†ç¬¬ä¸€çº§åŸå¸‚æ•°æ®ï¼Œæˆ‘ä»¬è¿˜è¦å±•ç¤ºç¬¬äºŒçº§å’Œç¬¬ä¸‰çº§æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹å¾—åˆ°çš„ç¬¬ä¸€çº§æ•°æ®åšä¸€äº›å¤„ç†ã€‚æ·»åŠ ä¸€ä¸ª<font color="#FF8C00">func handleLevelData()</font>æ–¹æ³•å¤„ç†æ•°æ®ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬é»˜è®¤é€‰ä¸­æ¯ä¸€çº§çš„ç¬¬ä¸€é¡¹ï¼Œè¿™å°±æ˜¯forå¾ªç¯çš„ä½œç”¨ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">handleLevelData</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> firstLevelItems = firstLevelItems <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> level <span class="keyword">in</span> <span class="number">0</span>..&lt;numberOfLvel &#123;</div><div class="line">        <span class="keyword">if</span> selectedLevelItems.<span class="built_in">count</span> == <span class="number">0</span> &#123;</div><div class="line">            selectedLevelItems.append(firstLevelItems[<span class="number">0</span>])</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> nextLevelItems = selectedLevelItems[level - <span class="number">1</span>]?.nextLevelItems &#123;</div><div class="line">                selectedLevelItems.append(nextLevelItems[<span class="number">0</span>])</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                selectedLevelItems.append(<span class="literal">nil</span>)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å¯¹MultiLevelMenuç±»è¿›è¡Œä¸¤å¤„ä¿®æ”¹ã€‚é¦–å…ˆè®©æˆ‘ä»¬æˆ‘ä»¬æ‰¾åˆ°dataSourceè¿™ä¸ªå±æ€§ï¼Œä¿®æ”¹å®ƒçš„å±æ€§è§‚å¯Ÿè€…ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">weak</span> <span class="keyword">var</span> dataSource: <span class="type">MultiLevelMenuDataSource</span>? &#123;</div><div class="line">    <span class="keyword">didSet</span> &#123;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> dataSource = dataSource <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        numberOfLvel = dataSource.numberOfLevel(of: <span class="keyword">self</span>)</div><div class="line">        firstLevelItems = dataSource.firstLevelItems(of: <span class="keyword">self</span>)</div><div class="line">        handleLevelData()</div><div class="line">        createMenuTableView()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ•°æ®å·²ç»å¤„ç†å¥½ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬ä¿®æ”¹tableviewçš„æ•°æ®æºæ–¹æ³•ï¼Œå°†æ•°æ®å±•ç¤ºå‡ºæ¥ã€‚ä¿®æ”¹å¦‚ä¸‹ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, numberOfRowsInSection section: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    <span class="keyword">let</span> level = tableView.tag - <span class="number">100</span></div><div class="line">    <span class="keyword">if</span> level == <span class="number">0</span> &#123;</div><div class="line">        <span class="keyword">return</span> firstLevelItems?.<span class="built_in">count</span> ?? <span class="number">0</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> selectedLevelItems[level - <span class="number">1</span>]?.nextLevelItems?.<span class="built_in">count</span> ?? <span class="number">0</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, cellForRowAt indexPath: IndexPath)</span></span> -&gt; <span class="type">UITableViewCell</span> &#123;</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> level = tableView.tag - <span class="number">100</span></div><div class="line">    </div><div class="line">    <span class="keyword">var</span> levelItem: <span class="type">LeveItemProtocol</span>?</div><div class="line">    <span class="keyword">if</span> level == <span class="number">0</span> &#123;</div><div class="line">        levelItem = firstLevelItems?[indexPath.row]</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        levelItem = selectedLevelItems[level - <span class="number">1</span>]?.nextLevelItems?[indexPath.row]</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">let</span> cell = tableView.dequeueReusableCell(withIdentifier: <span class="type">LevelItemCellReuseIdentifier</span>, <span class="keyword">for</span>: indexPath) <span class="keyword">as</span>! <span class="type">LevelItemCell</span></div><div class="line">    </div><div class="line">    cell.levelNamelabel.text = levelItem?.levelName</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> cell</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬é€šè¿‡é€‰ä¸­çš„çº§åˆ«æ¥åˆ¤æ–­éœ€è¦æ˜¾ç¤ºåœ¨tableviewä¸­å¤šå°‘è¡Œï¼Œåœ¨è¿™é‡Œç¬¬ä¸€çº§åˆ«ä¸ºçœï¼Œæˆ‘ä»¬ç›´æ¥è¿”å›ç¬¬ä¸€çº§åˆ«çš„æ•°ç›®ï¼Œå¯¹äºç¬¬äºŒçº§åˆ«(ç›¸å¯¹äºçœæ¥è¯´ä¸ºå¸‚è¿™ä¸ªçº§åˆ«)ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®é€‰ä¸­çš„ç¬¬ä¸€çº§åˆ«æ¥åˆ¤æ–­éœ€è¦æ˜¾ç¤ºå¤šå°‘è¡Œï¼Œé€šè¿‡ä¸Šä¸€çº§çš„nextLevelItemså±æ€§ï¼Œå¯ä»¥è·å¾—è¯¥çº§åˆ«çš„æ‰€æœ‰ä¸‹ä¸€çº§é¡¹ï¼Œæˆ‘ä»¬è¿”å›æ‰€æœ‰ä¸‹ä¸€çº§çš„æ•°é‡ã€‚å¯¹äºç¬¬ä¸‰çº§åˆ«ä¹Ÿç”¨åŒæ ·çš„æ–¹æ³•å¾—åˆ°éœ€è¦æ˜¾ç¤ºçš„è¡Œæ•°ã€‚å¾—åˆ°ä¸‹ä¸€çº§æ•°é‡çš„é€»è¾‘æ˜¯åœ¨elseå­å¥ä¸­ã€‚</p>
<p>æœ‰äº†è¡Œæ•°ä¹‹åï¼Œæˆ‘ä»¬ç®€å•çš„å¯¹cellé…ç½®ï¼Œæˆ‘ä»¬æ ¹æ®å½“å‰æ˜¾ç¤ºçš„çº§åˆ«ï¼Œè·å¾—éœ€è¦æ˜¾ç¤ºçš„æ¡ç›®ï¼Œè¿™éƒ¨åˆ†é€»è¾‘å’Œè·å¾—è¡Œæ•°çš„é€»è¾‘æ˜¯å‡ ä¹ä¸€æ ·çš„ï¼Œæœ€åæˆ‘ä»¬å°†çº§åˆ«çš„åç§°è®¾ç½®åˆ°cellä¸Šã€‚</p>
<p>è¿è¡Œä¸€éçœ‹çœ‹æ•ˆæœã€‚</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/result1.png?imageView2/2/w/375" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ­£ç¡®çš„å±•ç¤ºäº†åŸå¸‚æ•°æ®ï¼Œç›®å‰é»˜è®¤æ˜¾ç¤ºçš„æ˜¯åŒ—äº¬åœ°åŒºã€‚åªæ˜¯ç°åœ¨è¿˜æœ‰ä¸€äº›é—®é¢˜ï¼Œç‚¹å‡»ä»»ä½•ä¸€ä¸ªåŸå¸‚å¹¶æ²¡æœ‰æ›´æ–°å¯¹åº”çš„åŒºåŸŸã€‚ç°åœ¨æˆ‘ä»¬å°±æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>æ»šåŠ¨åˆ°æ–‡ä»¶çš„æœ«å°¾ï¼Œæ‰¾åˆ°MultiLevelMenuçš„UITableViewDelegateè¿™ä¸ªextensionéƒ¨åˆ†ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå®ç°<font color="#FF8C00">func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath)</font>ä»£ç†æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨tableviewçš„æŸä¸€è¡Œè¢«é€‰ä¸­æ—¶ä¼šè¢«è°ƒç”¨ã€‚æ·»åŠ ä»¥ä¸‹ä»£ç æ®µã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, didSelectRowAt indexPath: IndexPath)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> level = tableView.tag - <span class="number">100</span></div><div class="line">    updateNextLevelItems(selectedLevel: level, on: indexPath)</div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="comment">// é€‰ä¸­æŸä¸€çº§åˆ«ï¼Œéœ€è¦æ›´æ–°å¯¹åº”çš„ä¸‹ä¸€çº§åˆ«</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">updateNextLevelItems</span><span class="params">(selectedLevel: Int, on indexPath: IndexPath)</span></span> &#123;</div><div class="line">    <span class="comment">// æ›´æ–°å¯¹åº”çš„ä¸‹ä¸€çº§åˆ«</span></div><div class="line">    <span class="keyword">if</span> selectedLevel == <span class="number">0</span> &#123;</div><div class="line">        selectedLevelItems[<span class="number">0</span>] = firstLevelItems?[indexPath.row]</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        selectedLevelItems[selectedLevel] = selectedLevelItems[selectedLevel - <span class="number">1</span>]?.nextLevelItems?[indexPath.row]</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// åç»­é€‰ä¸­çš„ä¸‹ä¸€çº§åˆ«é»˜è®¤ä¸ºç¬¬ä¸€é¡¹</span></div><div class="line">    <span class="keyword">for</span> level <span class="keyword">in</span> (selectedLevel+<span class="number">1</span>)..&lt;numberOfLvel &#123;</div><div class="line">        selectedLevelItems[level] = selectedLevelItems[level - <span class="number">1</span>]?.nextLevelItems?.first</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// åˆ·æ–°åç»­çš„tableview</span></div><div class="line">    <span class="keyword">for</span> level <span class="keyword">in</span> (selectedLevel+<span class="number">1</span>)..&lt;numberOfLvel &#123;</div><div class="line">        menuTableViews[level].reloadData()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬å¯¹é€‰ä¸­çº§åˆ«åšäº†æ›´æ–°ï¼Œå¹¶ä¸”åˆ·æ–°å¯¹åº”çš„tableviewã€‚å®Œæˆä¹‹åï¼Œå†æ¬¡è¿è¡Œç¨‹åºï¼Œç°åœ¨é€‰ä¸­ä»»ä½•åŸå¸‚ï¼Œéƒ½èƒ½å¤Ÿæ˜¾ç¤ºå¯¹åº”çš„åŸå¸‚ä¿¡æ¯ã€‚ä¸‹å›¾æ˜¯é€‰ä¸­å¹¿ä¸œçœï¼Œç æµ·å¸‚çš„ç»“æœã€‚</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/result2.png?imageView2/2/w/375" alt=""></p>
<p>åˆ°è¿™é‡Œä¸ºæ­¢ï¼Œæˆ‘ä»¬å¤§éƒ¨åˆ†çš„å·¥ä½œå·²ç»å®Œæˆäº†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¿˜å¯ä»¥ä¸ºMultiLevelMenuå£°æ˜ä»£ç†åè®®ï¼Œé€šè¿‡è¿™äº›ä»£ç†åè®®ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¶å®šMultiLevelMenuçš„å¤–è§‚ï¼Œä»¥åŠå‘ŠçŸ¥å¤–ç•Œæˆ‘ä»¬é€‰ä¸­çš„çº§åˆ«ä¿¡æ¯ã€‚æ‰¾åˆ°<font color="#FF8C00">MultiLevelMenuDataSource</font>æ•°æ®æºåè®®å£°æ˜çš„ä½ç½®ï¼Œåœ¨å®ƒçš„ä¸‹æ–¹æ·»åŠ <font color="#FF8C00">MultiLevelMenuDelegate</font>ä»£ç†åè®®çš„å£°æ˜ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@objc</span> <span class="class"><span class="keyword">protocol</span> <span class="title">MultiLevelMenuDelegate</span>: <span class="title">NSObjectProtocol</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="meta">@objc</span> <span class="keyword">optional</span> <span class="function"><span class="keyword">func</span> <span class="title">multiLevelMenu</span><span class="params">(multiLevelMenu: MultiLevelMenu, backgroundColorForLevel level: Int)</span></span> -&gt; <span class="type">UIColor</span></div><div class="line">    <span class="meta">@objc</span> <span class="keyword">optional</span> <span class="function"><span class="keyword">func</span> <span class="title">multiLevelMenu</span><span class="params">(multiLevelMenu: MultiLevelMenu, widthRatioForLevel level: Int)</span></span> -&gt; <span class="type">CGFloat</span></div><div class="line">    </div><div class="line">    <span class="meta">@objc</span> <span class="keyword">optional</span> <span class="function"><span class="keyword">func</span> <span class="title">multiLevelMenu</span><span class="params">(multiLevelMenu: MultiLevelMenu, didSelectedLastLevel selectedLevelItems: [LeveItemProtocol])</span></span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¸‰ä¸ªä»£ç†æ–¹æ³•éƒ½æ˜¯å¯é€‰çš„ï¼Œæ²¡æœ‰å¿…è¦å…¨éƒ¨å®ç°ã€‚ä»ä¸Šä¹‹ä¸‹æ¯ä¸ªæ–¹æ³•çš„ä½œç”¨ä¸ºï¼š</p>
<blockquote>
<ul>
<li>ä»å¤–ç•Œå¾—åˆ°æ¯ä¸€çº§åˆ«tableviewçš„èƒŒæ™¯è‰²</li>
<li>å¾—åˆ°æ¯ä¸€çº§åˆ«tableviewçš„æ˜¾ç¤ºå®½åº¦æ¯”ä¾‹</li>
<li>å‘ŠçŸ¥å¤–ç•Œæˆ‘ä»¬é€‰ä¸­çš„çº§åˆ«</li>
</ul>
</blockquote>
<p>ä»£ç†åè®®å£°æ˜å¥½ä¹‹åï¼Œæˆ‘ä»¬ä¸ºMultiLevelMenuæ·»åŠ ä¸€ä¸ªdelegateå˜é‡ï¼Œä»¥åŠä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«ç”¨æ¥æ”¹å˜tableviewçš„èƒŒæ™¯è‰²å’Œæ˜¾ç¤ºå®½åº¦ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•ä¼šåœ¨ä»å¤–ç•Œè·å¾—èƒŒæ™¯è‰²å’Œæ˜¾ç¤ºå®½åº¦æ¯”ä¾‹æ—¶è¢«è°ƒç”¨ã€‚</p>
<p>é¦–å…ˆå£°æ˜delegateå˜é‡</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">weak</span> <span class="keyword">var</span> delegate: <span class="type">MultiLevelMenuDelegate</span>?</div></pre></td></tr></table></figure>
<p>å†æ·»åŠ è°ƒæ•´èƒŒæ™¯è‰²å’Œå®½åº¦çš„æ–¹æ³•</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">changeTableViewBackgroudColor</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">for</span> level <span class="keyword">in</span> <span class="number">0</span>..&lt;numberOfLvel &#123;</div><div class="line">        <span class="keyword">let</span> backgroundColor = <span class="keyword">self</span>.delegate!.multiLevelMenu!(multiLevelMenu: <span class="keyword">self</span>, backgroundColorForLevel: level)</div><div class="line">        menuTableViews[level].backgroundColor = backgroundColor</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">remakeTableViewConstraints</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="keyword">for</span> level <span class="keyword">in</span> <span class="number">0</span>..&lt;numberOfLvel &#123;</div><div class="line">        <span class="keyword">let</span> widthRatio = <span class="keyword">self</span>.delegate!.multiLevelMenu!(multiLevelMenu: <span class="keyword">self</span>, widthRatioForLevel: level)</div><div class="line">        <span class="keyword">let</span> tableView = menuTableViews[level]</div><div class="line">        </div><div class="line">        tableView.snp.remakeConstraints(&#123; (make) <span class="keyword">in</span></div><div class="line">            make.top.bottom.equalToSuperview()</div><div class="line">            make.width.equalToSuperview().multipliedBy(widthRatio)</div><div class="line">            </div><div class="line">            <span class="keyword">if</span> level == <span class="number">0</span> &#123;</div><div class="line">                make.leading.equalToSuperview()</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                make.leading.equalTo(<span class="keyword">self</span>.menuTableViews[level - <span class="number">1</span>].snp.trailing)</div><div class="line">            &#125;</div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯¹delegateå’Œå¯é€‰æ–¹æ³•è¿›è¡Œäº†å¼ºåˆ¶è§£åŒ…ï¼Œè¿™é‡Œæœ¬æ¥åº”è¯¥åšåˆ¤ç©ºå¤„ç†çš„ï¼Œå¾…ä¼šæˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸éœ€è¦åœ¨è¿™é‡Œåšåˆ¤ç©ºå¤„ç†ã€‚æˆ‘ä»¬è°ƒæ•´tableviewçš„å®½åº¦ï¼Œæ˜¯é€šè¿‡è®¾ç½®å®½åº¦çº¦æŸæ¥å®ç°çš„ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æ‰¾åˆ°delegateå˜é‡ï¼Œä¸ºå®ƒå¢åŠ å±æ€§è§‚å¯Ÿå™¨.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">weak</span> <span class="keyword">var</span> delegate: <span class="type">MultiLevelMenuDelegate</span>? &#123;</div><div class="line">    <span class="keyword">didSet</span> &#123;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> delegate = delegate <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> delegate.responds(to: #selector(<span class="type">MultiLevelMenuDelegate</span>.multiLevelMenu(multiLevelMenu:backgroundColorForLevel:))) &#123;</div><div class="line">            changeTableViewBackgroudColor()</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> delegate.responds(to: #selector(<span class="type">MultiLevelMenuDelegate</span>.multiLevelMenu(multiLevelMenu:backgroundColorForLevel:))) &#123;</div><div class="line">            remakeTableViewConstraints()</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨delegateå˜é‡è¢«è®¾ç½®ä¹‹åï¼Œæˆ‘ä»¬å»æ”¹å˜tableviewçš„èƒŒæ™¯è‰²å’Œæ˜¾ç¤ºå®½åº¦ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œåšäº†åˆ¤ç©ºæ“ä½œï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸éœ€è¦åœ¨å‰é¢ä¸¤ä¸ªæ–¹æ³•ä¸­è¿›è¡Œåˆ¤ç©ºæ“ä½œçš„åŸå› ã€‚</p>
<p>åˆ‡æ¢åˆ°HomeViewController.swiftæ–‡ä»¶ï¼Œä¸ºHomeViewControlleræ·»åŠ MultiLevelMenuDelegateåè®®çš„å®ç°ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">HomeViewController</span>: <span class="title">MultiLevelMenuDelegate</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">multiLevelMenu</span><span class="params">(multiLevelMenu: MultiLevelMenu, backgroundColorForLevel level: Int)</span></span> -&gt; <span class="type">UIColor</span> &#123;</div><div class="line">        <span class="keyword">if</span> level == <span class="number">0</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="type">UIColor</span>(white: <span class="number">0.92</span>, alpha: <span class="number">1.0</span>)</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> level == <span class="number">1</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="type">UIColor</span>(white: <span class="number">0.94</span>, alpha: <span class="number">1.0</span>)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="type">UIColor</span>(white: <span class="number">0.96</span>, alpha: <span class="number">1.0</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">multiLevelMenu</span><span class="params">(multiLevelMenu: MultiLevelMenu, widthRatioForLevel level: Int)</span></span> -&gt; <span class="type">CGFloat</span> &#123;</div><div class="line">        <span class="keyword">if</span> level == <span class="number">0</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">0.24</span></div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> level == <span class="number">1</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">0.38</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="number">0.38</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„é¢œè‰²å’Œå®½åº¦æ¯”ä¾‹å¯ä»¥æ ¹æ®éœ€æ±‚è°ƒæ•´ã€‚æœ€åä¸è¦å¿˜è®°è®¾ç½®MultiLevelMenuå¯¹è±¡çš„delegateå±æ€§ä¸ºselfï¼Œæ‰¾çš„multiLevelMenuçš„å£°æ˜å¤„ï¼Œæ·»åŠ ä¸€è¡Œä»£ç ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">multiLevelMenu.delegate = <span class="keyword">self</span></div></pre></td></tr></table></figure>
<p>æœ€åè¿è¡Œæˆ‘ä»¬çš„ç¨‹åºçœ‹çœ‹æ•ˆæœï¼Œçœ‹èµ·æ¥æ•ˆæœè¿˜æ˜¯å¯ä»¥çš„ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å®ç°MultiLevelMenuDelegateåè®®çš„æœ€åä¸€ä¸ªä»£ç†æ–¹æ³•</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/result3.png?imageView2/2/w/375" alt=""></p>
<p>åœ¨æˆ‘ä»¬åˆšåˆšçš„extensionéƒ¨åˆ†ï¼Œå®ç°æœ€åä¸€ä¸ªä»£ç†æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ˜¯ç®€å•çš„æ‰“å°çº§åˆ«åç§°ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">multiLevelMenu</span><span class="params">(multiLevelMenu: MultiLevelMenu, didSelectedLastLevel selectedLevelItems: [LeveItemProtocol])</span></span> &#123;</div><div class="line">    <span class="keyword">for</span> levelItem <span class="keyword">in</span> selectedLevelItems &#123;</div><div class="line">        <span class="built_in">print</span>(levelItem.levelName)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å›åˆ°MultiLevelMenu.swiftæ–‡ä»¶ï¼Œæ˜¯æ—¶å€™å‘ŠçŸ¥å¤–ç•Œæˆ‘ä»¬é€‰ä¸­çš„çº§åˆ«ä¿¡æ¯äº†ã€‚ä¿®æ”¹tableviewé€‰ä¸­æŸä¸€è¡Œçš„ä»£ç†æ–¹æ³•ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(<span class="number">_</span> tableView: UITableView, didSelectRowAt indexPath: IndexPath)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> level = tableView.tag - <span class="number">100</span></div><div class="line">    updateNextLevelItems(selectedLevel: level, on: indexPath)</div><div class="line">    </div><div class="line">    <span class="comment">// æ£€æŸ¥æ˜¯å¦é€‰ä¸­äº†æœ€åä¸€ä¸ªçº§åˆ«ï¼Œå¹¶å¯¹delegateå’Œå¯é€‰æ–¹æ³•è¿›è¡Œåˆ¤ç©ºæ“ä½œ</span></div><div class="line">    <span class="keyword">if</span> (selectedLevelItems[level]?.nextLevelItems == <span class="literal">nil</span>)</div><div class="line">        &amp;&amp; (delegate != <span class="literal">nil</span>)</div><div class="line">        &amp;&amp; (delegate!.responds(to: #selector(<span class="type">MultiLevelMenuDelegate</span>.multiLevelMenu(multiLevelMenu:didSelectedLastLevel:)))) &#123;</div><div class="line">        delegate?.multiLevelMenu!(multiLevelMenu: <span class="keyword">self</span>, didSelectedLastLevel: selectedLevelItems.<span class="built_in">filter</span>&#123; $<span class="number">0</span> != <span class="literal">nil</span> &#125; <span class="keyword">as</span>! [<span class="type">LeveItemProtocol</span>])</div><div class="line">        dismiss(animated: <span class="literal">true</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œå¦‚æœæˆ‘ä»¬é€‰ä¸­äº†æœ€åä¸€çº§å°±å‘Šè¯‰å¤–ç•Œæˆ‘ä»¬é€‰ä¸­çš„çº§åˆ«ï¼Œå¹¶ç§»é™¤MultiLevelMenuã€‚è¿è¡Œçœ‹çœ‹æ•ˆæœï¼Œè¿™é‡Œæˆ‘ç¬¬ä¸€æ¬¡é€‰ä¸­äº†åŒ—äº¬çš„æœé˜³åŒºï¼Œç¬¬äºŒæ¬¡é€‰ä¸­äº†å¹¿ä¸œä½›å±±çš„ä¸‰æ°´åŒºï¼Œéƒ½æ­£ç¡®çš„åœ¨æ§åˆ¶å°æ‰“å°å‡ºæ¥äº†ã€‚</p>
<p><img src="http://op6guxky2.bkt.clouddn.com/result5.png" alt=""></p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥ä¸ºMultiLevelMenuçš„å±•ç°å’Œç§»é™¤æ·»åŠ åŠ¨ç”»ã€‚é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ°<font color="#FF8C00">presnt(from view: UIView)</font>æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•çš„æœ€åï¼Œæ·»åŠ ä»¥ä¸‹å‡ è¡Œä»£ç ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1.æ”¹å˜çº¦æŸè®©containerViewçš„ä½ç½®åˆšå¥½åœ¨MultiLevelMenuæ§ä»¶çš„ä¸Šæ–¹ï¼Œå¹¶ä½¿çº¦æŸç«‹å³ç”Ÿæ•ˆ</span></div><div class="line"><span class="keyword">self</span>.containerView.snp.remakeConstraints &#123; (make) <span class="keyword">in</span></div><div class="line">    make.leading.trailing.equalToSuperview()</div><div class="line">    make.height.equalTo(<span class="number">240</span>)</div><div class="line">    make.bottom.equalTo(<span class="keyword">self</span>.snp.top)</div><div class="line">&#125;</div><div class="line"><span class="keyword">self</span>.layoutIfNeeded()</div><div class="line"><span class="keyword">self</span>.alpha = <span class="number">0.0</span></div><div class="line">    </div><div class="line"><span class="comment">// 2.æ¢å¤containerViewåˆ°åŸæ¥çš„ä½ç½®ï¼Œä½¿ç”¨åŠ¨ç”»è®©çº¦æŸé€æ­¥ç”Ÿæ•ˆ</span></div><div class="line"><span class="keyword">self</span>.containerView.snp.remakeConstraints &#123; (make) <span class="keyword">in</span></div><div class="line">    make.leading.top.trailing.equalToSuperview()</div><div class="line">    make.height.equalTo(<span class="number">240</span>)</div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="type">UIView</span>.animate(withDuration: <span class="type">CATransaction</span>.animationDuration()) &#123; </div><div class="line">    <span class="keyword">self</span>.alpha = <span class="number">1.0</span></div><div class="line">    <span class="keyword">self</span>.layoutIfNeeded()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿™é‡Œè®¾ç½®é€šè¿‡è®©containerViewä»ä¸Šå¾€ä¸‹ç§»åŠ¨ï¼Œä»¥åŠæ”¹å˜MultiLevelMenuæ§ä»¶çš„é€æ˜åº¦ï¼Œäº§ç”Ÿä¸€ä¸ªåŠ¨ç”»ã€‚</p>
<p>æˆ‘ä»¬è¿˜éœ€è¦åœ¨MultiLevelMenuçš„ç±»çš„åˆå§‹åŒ–ä¸­æ·»åŠ ä¸€è¡Œä»£ç ï¼Œå®ƒè®©è¶…å‡ºMultiLevelMenuæ§ä»¶çš„å†…å®¹ä¸å¯è§ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">self</span>.clipsToBounds = <span class="literal">true</span></div></pre></td></tr></table></figure>
<p>ç°åœ¨ä¿®æ”¹<font color="#FF8C00">func dismiss(animated: Bool)</font>æ–¹æ³•ï¼Œå¹¶æ·»åŠ å¤„ç†è§¦æ‘¸äº‹ä»¶çš„æ–¹æ³•ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">dismiss</span><span class="params">(animated: Bool)</span></span> &#123;</div><div class="line">    <span class="keyword">if</span> animated &#123;</div><div class="line">        <span class="type">UIView</span>.animate(withDuration: <span class="type">CATransaction</span>.animationDuration(), animations: &#123; </div><div class="line">            <span class="keyword">self</span>.alpha = <span class="number">0.0</span></div><div class="line">        &#125;, completion: &#123; (<span class="number">_</span>) <span class="keyword">in</span></div><div class="line">            <span class="keyword">self</span>.removeFromSuperview()</div><div class="line">        &#125;)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">self</span>.removeFromSuperview()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    isShowed = <span class="literal">false</span></div><div class="line">&#125;</div><div class="line">    </div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">touchesBegan</span><span class="params">(<span class="number">_</span> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span> &#123;</div><div class="line">    dismiss(animated: <span class="literal">true</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ç§»é™¤MultiLevelMenuæ§ä»¶æ—¶ï¼Œæˆ‘ä»¬å…ˆå°†å®ƒçš„é€æ˜åº¦å˜ä¸º0ï¼Œå®Œæˆä¹‹åå†ç§»é™¤ã€‚è¿è¡Œçœ‹çœ‹æ•ˆæœå§ï¼Œåˆ°è¿™é‡Œæˆ‘ä»¬çš„æ•´ä¸ªdemoå°±ç®—æ˜¯å®Œæˆäº†ğŸ˜ƒğŸ˜ƒã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿å¯¹ç…§ï¼Œå¯ä»¥åœ¨<a href="https://github.com/EgeTart/MlutiLevelMenuDemo">è¿™é‡Œ</a>ä¸‹è½½demoã€‚</p>

        </div>
      </article>
    </div>
    <!-- Comments -->
    <div class="container">
      
<section id="comment">
  <!-- <h1 class="title">Comments</h1> -->

  
</section>


    </div>
    <!-- Pre or Next -->
    <div class="nav-links">
      
      
        <div class="nav-next">
          <a href="/2017/07/27/iOS-tips/" rel="next">Newer Posts <span class="meta-arraw meta-arraw-right"></span></a>
        </div>
      
    </div>

  </div>
</div>


  <!-- Footer -->
  <!-- Footer-widgets -->
<div class="footer-widgets">
  <div class="row inside-wrapper">
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">å…³äºæœ¬ç«™</h1>
        <div class="custom-widget-content">
          
          <p style="font-size:16pt;color:#333333;text-align:center">è®°å½•iOSå¼€å‘çŸ¥è¯†, ä¹Ÿè®°å½•è‡ªå·±çš„ä¸€äº›éšæ„Ÿéšæƒ³....</p>
        </div>
      </aside>
    </div>
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">Contact</h1>
        <div class="widget-text">
          
            
              <a href="https://github.com/xiazihan" class="icon icon-github" target="_blank">github</a>
            
              <a href="mailto:gaoyongxiao@meituan.com" class="icon icon-mail" target="_blank">mail</a>
            
          
        </div>
      </aside>
    </div>
    <div class="col-1-3">
      <aside>
        <h1 class="widget-title">Search</h1>
        <div class="widget-text">
          <form onSubmit="return appDaily.submitSearch('')">
            <p>
              <input type="text" placeholder="search..." id="homeSearchInput">
            </p>
            <!-- <input type="submit" value="GO"> -->
          </form>
        </div>
      </aside>
    </div>
  </div>
</div>
<!-- Footer -->
<footer class="site-info">
  <p>
    <span>ZiHan Blog &copy; 2017</span>
    
      <span class="split">|</span>
      <span>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> with Theme <a href="https://github.com/GallenHu/hexo-theme-Daily" target="_blank">Daily</a></span>
    
  </p>
</footer>


  <!-- After footer scripts -->
  <!-- scripts -->
<script src="/js/app.js"></script>





</body>

</html>